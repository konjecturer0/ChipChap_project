{"ast":null,"code":"/** @license MIT License (c) copyright 2010-2014 original author or authors */\n\n/** @author Brian Cavalier */\n\n/** @author John Hann */\n(function (define) {\n  'use strict';\n\n  define(function (require) {\n    var env = require('../env');\n\n    var TimeoutError = require('../TimeoutError');\n\n    function setTimeout(f, ms, x, y) {\n      return env.setTimer(function () {\n        f(x, y, ms);\n      }, ms);\n    }\n\n    return function timed(Promise) {\n      /**\n       * Return a new promise whose fulfillment value is revealed only\n       * after ms milliseconds\n       * @param {number} ms milliseconds\n       * @returns {Promise}\n       */\n      Promise.prototype.delay = function (ms) {\n        var p = this._beget();\n\n        this._handler.fold(handleDelay, ms, void 0, p._handler);\n\n        return p;\n      };\n\n      function handleDelay(ms, x, h) {\n        setTimeout(resolveDelay, ms, x, h);\n      }\n\n      function resolveDelay(x, h) {\n        h.resolve(x);\n      }\n      /**\n       * Return a new promise that rejects after ms milliseconds unless\n       * this promise fulfills earlier, in which case the returned promise\n       * fulfills with the same value.\n       * @param {number} ms milliseconds\n       * @param {Error|*=} reason optional rejection reason to use, defaults\n       *   to a TimeoutError if not provided\n       * @returns {Promise}\n       */\n\n\n      Promise.prototype.timeout = function (ms, reason) {\n        var p = this._beget();\n\n        var h = p._handler;\n        var t = setTimeout(onTimeout, ms, reason, p._handler);\n\n        this._handler.visit(h, function onFulfill(x) {\n          env.clearTimer(t);\n          this.resolve(x); // this = h\n        }, function onReject(x) {\n          env.clearTimer(t);\n          this.reject(x); // this = h\n        }, h.notify);\n\n        return p;\n      };\n\n      function onTimeout(reason, h, ms) {\n        var e = typeof reason === 'undefined' ? new TimeoutError('timed out after ' + ms + 'ms') : reason;\n        h.reject(e);\n      }\n\n      return Promise;\n    };\n  });\n})(typeof define === 'function' && define.amd ? define : function (factory) {\n  module.exports = factory(require);\n});","map":{"version":3,"sources":["/home/vladic4t/Desktop/mydev/ChipChapProject/chipchap/node_modules/when/lib/decorators/timed.js"],"names":["define","require","env","TimeoutError","setTimeout","f","ms","x","y","setTimer","timed","Promise","prototype","delay","p","_beget","_handler","fold","handleDelay","h","resolveDelay","resolve","timeout","reason","t","onTimeout","visit","onFulfill","clearTimer","onReject","reject","notify","e","amd","factory","module","exports"],"mappings":"AAAA;;AACA;;AACA;AAEC,WAASA,MAAT,EAAiB;AAAE;;AACpBA,EAAAA,MAAM,CAAC,UAASC,OAAT,EAAkB;AAExB,QAAIC,GAAG,GAAGD,OAAO,CAAC,QAAD,CAAjB;;AACA,QAAIE,YAAY,GAAGF,OAAO,CAAC,iBAAD,CAA1B;;AAEA,aAASG,UAAT,CAAoBC,CAApB,EAAuBC,EAAvB,EAA2BC,CAA3B,EAA8BC,CAA9B,EAAiC;AAChC,aAAON,GAAG,CAACO,QAAJ,CAAa,YAAW;AAC9BJ,QAAAA,CAAC,CAACE,CAAD,EAAIC,CAAJ,EAAOF,EAAP,CAAD;AACA,OAFM,EAEJA,EAFI,CAAP;AAGA;;AAED,WAAO,SAASI,KAAT,CAAeC,OAAf,EAAwB;AAC9B;;;;;;AAMAA,MAAAA,OAAO,CAACC,SAAR,CAAkBC,KAAlB,GAA0B,UAASP,EAAT,EAAa;AACtC,YAAIQ,CAAC,GAAG,KAAKC,MAAL,EAAR;;AACA,aAAKC,QAAL,CAAcC,IAAd,CAAmBC,WAAnB,EAAgCZ,EAAhC,EAAoC,KAAK,CAAzC,EAA4CQ,CAAC,CAACE,QAA9C;;AACA,eAAOF,CAAP;AACA,OAJD;;AAMA,eAASI,WAAT,CAAqBZ,EAArB,EAAyBC,CAAzB,EAA4BY,CAA5B,EAA+B;AAC9Bf,QAAAA,UAAU,CAACgB,YAAD,EAAed,EAAf,EAAmBC,CAAnB,EAAsBY,CAAtB,CAAV;AACA;;AAED,eAASC,YAAT,CAAsBb,CAAtB,EAAyBY,CAAzB,EAA4B;AAC3BA,QAAAA,CAAC,CAACE,OAAF,CAAUd,CAAV;AACA;AAED;;;;;;;;;;;AASAI,MAAAA,OAAO,CAACC,SAAR,CAAkBU,OAAlB,GAA4B,UAAShB,EAAT,EAAaiB,MAAb,EAAqB;AAChD,YAAIT,CAAC,GAAG,KAAKC,MAAL,EAAR;;AACA,YAAII,CAAC,GAAGL,CAAC,CAACE,QAAV;AAEA,YAAIQ,CAAC,GAAGpB,UAAU,CAACqB,SAAD,EAAYnB,EAAZ,EAAgBiB,MAAhB,EAAwBT,CAAC,CAACE,QAA1B,CAAlB;;AAEA,aAAKA,QAAL,CAAcU,KAAd,CAAoBP,CAApB,EACC,SAASQ,SAAT,CAAmBpB,CAAnB,EAAsB;AACrBL,UAAAA,GAAG,CAAC0B,UAAJ,CAAeJ,CAAf;AACA,eAAKH,OAAL,CAAad,CAAb,EAFqB,CAEJ;AACjB,SAJF,EAKC,SAASsB,QAAT,CAAkBtB,CAAlB,EAAqB;AACpBL,UAAAA,GAAG,CAAC0B,UAAJ,CAAeJ,CAAf;AACA,eAAKM,MAAL,CAAYvB,CAAZ,EAFoB,CAEJ;AAChB,SARF,EASCY,CAAC,CAACY,MATH;;AAWA,eAAOjB,CAAP;AACA,OAlBD;;AAoBA,eAASW,SAAT,CAAmBF,MAAnB,EAA2BJ,CAA3B,EAA8Bb,EAA9B,EAAkC;AACjC,YAAI0B,CAAC,GAAG,OAAOT,MAAP,KAAkB,WAAlB,GACL,IAAIpB,YAAJ,CAAiB,qBAAqBG,EAArB,GAA0B,IAA3C,CADK,GAELiB,MAFH;AAGAJ,QAAAA,CAAC,CAACW,MAAF,CAASE,CAAT;AACA;;AAED,aAAOrB,OAAP;AACA,KA1DD;AA4DA,GAvEK,CAAN;AAwEC,CAzEA,EAyEC,OAAOX,MAAP,KAAkB,UAAlB,IAAgCA,MAAM,CAACiC,GAAvC,GAA6CjC,MAA7C,GAAsD,UAASkC,OAAT,EAAkB;AAAEC,EAAAA,MAAM,CAACC,OAAP,GAAiBF,OAAO,CAACjC,OAAD,CAAxB;AAAoC,CAzE/G,CAAD","sourcesContent":["/** @license MIT License (c) copyright 2010-2014 original author or authors */\n/** @author Brian Cavalier */\n/** @author John Hann */\n\n(function(define) { 'use strict';\ndefine(function(require) {\n\n\tvar env = require('../env');\n\tvar TimeoutError = require('../TimeoutError');\n\n\tfunction setTimeout(f, ms, x, y) {\n\t\treturn env.setTimer(function() {\n\t\t\tf(x, y, ms);\n\t\t}, ms);\n\t}\n\n\treturn function timed(Promise) {\n\t\t/**\n\t\t * Return a new promise whose fulfillment value is revealed only\n\t\t * after ms milliseconds\n\t\t * @param {number} ms milliseconds\n\t\t * @returns {Promise}\n\t\t */\n\t\tPromise.prototype.delay = function(ms) {\n\t\t\tvar p = this._beget();\n\t\t\tthis._handler.fold(handleDelay, ms, void 0, p._handler);\n\t\t\treturn p;\n\t\t};\n\n\t\tfunction handleDelay(ms, x, h) {\n\t\t\tsetTimeout(resolveDelay, ms, x, h);\n\t\t}\n\n\t\tfunction resolveDelay(x, h) {\n\t\t\th.resolve(x);\n\t\t}\n\n\t\t/**\n\t\t * Return a new promise that rejects after ms milliseconds unless\n\t\t * this promise fulfills earlier, in which case the returned promise\n\t\t * fulfills with the same value.\n\t\t * @param {number} ms milliseconds\n\t\t * @param {Error|*=} reason optional rejection reason to use, defaults\n\t\t *   to a TimeoutError if not provided\n\t\t * @returns {Promise}\n\t\t */\n\t\tPromise.prototype.timeout = function(ms, reason) {\n\t\t\tvar p = this._beget();\n\t\t\tvar h = p._handler;\n\n\t\t\tvar t = setTimeout(onTimeout, ms, reason, p._handler);\n\n\t\t\tthis._handler.visit(h,\n\t\t\t\tfunction onFulfill(x) {\n\t\t\t\t\tenv.clearTimer(t);\n\t\t\t\t\tthis.resolve(x); // this = h\n\t\t\t\t},\n\t\t\t\tfunction onReject(x) {\n\t\t\t\t\tenv.clearTimer(t);\n\t\t\t\t\tthis.reject(x); // this = h\n\t\t\t\t},\n\t\t\t\th.notify);\n\n\t\t\treturn p;\n\t\t};\n\n\t\tfunction onTimeout(reason, h, ms) {\n\t\t\tvar e = typeof reason === 'undefined'\n\t\t\t\t? new TimeoutError('timed out after ' + ms + 'ms')\n\t\t\t\t: reason;\n\t\t\th.reject(e);\n\t\t}\n\n\t\treturn Promise;\n\t};\n\n});\n}(typeof define === 'function' && define.amd ? define : function(factory) { module.exports = factory(require); }));\n"]},"metadata":{},"sourceType":"script"}